<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Power Analysis in R - Designs with Covariates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Power Analysis in R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Intro</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./dp.html" rel="" target="">
 <span class="menu-text">Design Parameters</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./single-level.html" rel="" target="">
 <span class="menu-text">Single-Level Designs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./multilevel.html" rel="" target="">
 <span class="menu-text">Multilevel Designs</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#multilevel-design-parameters" id="toc-multilevel-design-parameters" class="nav-link active" data-scroll-target="#multilevel-design-parameters">Multilevel Design Parameters</a>
  <ul class="collapse">
  <li><a href="#design-parameters-for-the-german-school-context" id="toc-design-parameters-for-the-german-school-context" class="nav-link" data-scroll-target="#design-parameters-for-the-german-school-context">Design Parameters for the German School Context</a></li>
  </ul></li>
  <li><a href="#scenario-1-how-many-schools-are-required-for-a-2l-crt" id="toc-scenario-1-how-many-schools-are-required-for-a-2l-crt" class="nav-link" data-scroll-target="#scenario-1-how-many-schools-are-required-for-a-2l-crt">Scenario 1: How Many Schools are Required for a 2L-CRT?</a>
  <ul class="collapse">
  <li><a href="#step-1-choose-the-design-parameters" id="toc-step-1-choose-the-design-parameters" class="nav-link" data-scroll-target="#step-1-choose-the-design-parameters">Step 1: Choose the Design Parameters</a></li>
  <li><a href="#step-2-define-the-assumptions" id="toc-step-2-define-the-assumptions" class="nav-link" data-scroll-target="#step-2-define-the-assumptions">Step 2: Define the Assumptions</a></li>
  <li><a href="#step-3-power-analysis-with-powerupr" id="toc-step-3-power-analysis-with-powerupr" class="nav-link" data-scroll-target="#step-3-power-analysis-with-powerupr">Step 3: Power Analysis with PowerUpR</a></li>
  <li><a href="#step-4-plotting" id="toc-step-4-plotting" class="nav-link" data-scroll-target="#step-4-plotting">Step 4: Plotting</a></li>
  </ul></li>
  <li><a href="#scenario-2-how-many-schools-are-required-for-a-2l-crt" id="toc-scenario-2-how-many-schools-are-required-for-a-2l-crt" class="nav-link" data-scroll-target="#scenario-2-how-many-schools-are-required-for-a-2l-crt">Scenario 2: How Many Schools are Required for a 2L-CRT?</a>
  <ul class="collapse">
  <li><a href="#step-1-choose-the-design-parameters-1" id="toc-step-1-choose-the-design-parameters-1" class="nav-link" data-scroll-target="#step-1-choose-the-design-parameters-1">Step 1: Choose the Design Parameters</a></li>
  <li><a href="#step-2-define-the-assumptions-1" id="toc-step-2-define-the-assumptions-1" class="nav-link" data-scroll-target="#step-2-define-the-assumptions-1">Step 2: Define the Assumptions</a></li>
  <li><a href="#step-3-power-analysis-with-powerupr-1" id="toc-step-3-power-analysis-with-powerupr-1" class="nav-link" data-scroll-target="#step-3-power-analysis-with-powerupr-1">Step 3: Power Analysis with PowerUpR</a></li>
  <li><a href="#step-4-plotting-1" id="toc-step-4-plotting-1" class="nav-link" data-scroll-target="#step-4-plotting-1">Step 4: Plotting</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Designs with Covariates</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
.panel-tabset .nav-item {
  font-size: 13pt;
}
</style>
</div>
<p>In a CRT, entire groups of students (e.g.&nbsp;whole schools) are randomly assigned to the experimental groups; likewise, the treatment and control protocols are delivered at the cluster level.</p>
<p>In this tutorial, we will walk through the process of planning two CRT designs:</p>
<section id="scenario-4" class="level5">
<h5 class="anchored" data-anchor-id="scenario-4">Scenario 4</h5>
<p>We will start by planning a two-level CRT (2L-CRT) where students at L1 are nested within schools at L2 and entire schools are randomly assigned to the experimental conditions.</p>
</section>
<section id="scenario-5" class="level5">
<h5 class="anchored" data-anchor-id="scenario-5">Scenario 5</h5>
<p>Then, we will continue by planning a three-level CRT (3L-CRT) where students at L1 are nested within classrooms at L2 which are, in turn, nested within schools at L3. Here, randomization/treatment assignment occurs, again, at the school level.</p>
</section>
<section id="multilevel-design-parameters" class="level2">
<h2 class="anchored" data-anchor-id="multilevel-design-parameters">Multilevel Design Parameters</h2>
<p>To plan sensitive (i.e., sufficiently powered and precise) CRTs on student achievement, reliable estimates of multilevel design parameters that adequately mirror the clustered variance structure of the outcome are critical. These design parameters include:</p>
<ul>
<li><p><strong>Intraclass correlation coefficients (ICCs)</strong><br>
ρ values that quantify achievement differences between clusters</p></li>
<li><p><strong>Explained Variances</strong><br>
<em>R</em><sup>2</sup> values that quantify the proportions of explained variance by covariates at the various levels</p></li>
</ul>
<p>Generally, design parameters should match the peculiarities of the target research context as closely as possible (e.g., the target population of the intervention, the specific hierarchical data structure, and the achievement outcome under investigation). There are multiple resources of empirical values of ρ and <em>R</em><sup>2</sup>. A review of existing international and German research on design parameters for student achievement can be found in <span class="citation" data-cites="stallasch2021">Stallasch et al. (<a href="#ref-stallasch2021" role="doc-biblioref">2021</a>)</span>. A useful collection of respective estimates for the United States is the <a href="http://stateva.ci.northwestern.edu/">“Online Intraclass Correlation Database”</a> created by Larry V. Hedges and colleagues and hosted by the Institute for Policy Research at the Northwestern University.</p>
<section id="design-parameters-for-the-german-school-context" class="level3">
<h3 class="anchored" data-anchor-id="design-parameters-for-the-german-school-context">Design Parameters for the German School Context</h3>
<p>In this workshop, we draw on our own compilation of ρ and <em>R</em><sup>2</sup> values (and corresponding standard errors) for the German school system published in <span class="citation" data-cites="stallasch2021">Stallasch et al. (<a href="#ref-stallasch2021" role="doc-biblioref">2021</a>)</span>. Based on three longitudinal German large-scale assessments (NEPS, PISA-I+, and DESI) which provided achievement data across the entire school career (Grades 1 to 12), we generated design parameters that apply to:</p>
<ul>
<li><p>several student populations</p></li>
<li><p>both two-level (students within schools) and three-level designs (students within classrooms within schools)</p></li>
<li><p>a broad array of domains</p></li>
</ul>
<p><em>R</em><sup>2</sup> values at each level are available for three covariate sets:</p>
<ul>
<li><p>pretest scores</p></li>
<li><p>sociodemographic characteristics (comprising students’ gender and migration background, as well as parents’ educational attainment, and families’ HISEI)</p></li>
<li><p>the combination thereof</p></li>
</ul>
<p>The design parameters are provided via an interactive Excel file (Supplemental Online Material B) that comes with a detailed introduction on the application scopes of the various sets of estimates. This document can be downloaded from the <a href="https://osf.io/2w8nt/">OSF</a> or the <a href="https://www.tandfonline.com/doi/suppl/10.1080/19345747.2020.1823539?scroll=top">Journal’s website</a>.</p>
<p>To facilitate the workflow in R (e.g., to avoid time-consuming and error-prone C&amp;P of estimates), an .rda file that encloses the full compilation of design parameters (as a list of data frames) is shared in <a href="https://github.com/sophiestallasch/2022-workshop-CRT">this course’s repository on github</a> which is ready to be directly loaded:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load design parameters from github</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://github.com/sophiestallasch/2022-workshop-CRT/blob/main/data/multides1.rda?raw=true"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you run into problems, <a href="https://github.com/sophiestallasch/2022-workshop-CRT/blob/main/data/multides1.rda?raw=true">click here</a> to download the data to your local machine and then load it into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect list</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multides1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Length Class  Mode
B1_General             28     tbl_df list
B2_General_ND          14     tbl_df list
B3_Adjusted            28     tbl_df list
B4_Adjusted_ND         14     tbl_df list
B5_Academic            28     tbl_df list
B6_Academic_ND         14     tbl_df list
B7_Non-Academic        28     tbl_df list
B8_Non-Academic_ND     14     tbl_df list
B9_General-2l          20     tbl_df list
B10_General-2l_ND      10     tbl_df list
B11_Adjusted-2l        20     tbl_df list
B12_Adjusted-2l_ND     10     tbl_df list
B13_Academic-2l        20     tbl_df list
B14_Academic-2l_ND     10     tbl_df list
B15_Non-Academic-2l    20     tbl_df list
B16_Non-Academic-2l_ND 10     tbl_df list</code></pre>
</div>
</div>
<p>The list contains 16 data frames, that can be grouped into two broad classes:</p>
<ul>
<li><p><strong>Point Estimates and Standard Errors</strong><br>
Data frames B1, B3, B5, B7, B9, B11, B13, and B15 contain the full sets of (population-specific) empirical estimates of design parameters for each domain, subdomain, and grade, along with their standard errors.</p></li>
<li><p><strong>Normative Distributions</strong><br>
Data frames B2, B4, B6, B8, B10, B12, B14, and B16 (all data frames ending with “_ND”) contain (population-specific) normative distributions (i.e., minimum, 25th percentile, median, 75th percentile, and maximum) of those design parameters summarized across domains and/or grades. These distributions can serve as guesstimates to plan studies whose target domain and/or grade is not covered in .</p></li>
</ul>
<section id="overview-of-data-frames" class="level4">
<h4 class="anchored" data-anchor-id="overview-of-data-frames">Overview of Data Frames</h4>
<p>We also created a flow chart to guide the choice of appropriate design parameters as a function of key characteristics of the target intervention.</p>
<p><img src="img/flowchart.png" class="img-fluid"></p>
</section>
<section id="structure-of-data-frames" class="level4">
<h4 class="anchored" data-anchor-id="structure-of-data-frames">Structure of Data Frames</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Point Estimates and Standard Errors</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Normative Distributions</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Data frames that contain the point estimates and standard errors (i.e., B1, B3, B5, B7, B9, B11, B13, and B15) are structured as follows.</p>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>domain</td>
<td>Domain of achievement outcome (for details, see section ‘Achievement Domains’)</td>
</tr>
<tr class="even">
<td>subdomain</td>
<td>Subdomain of achievement outcome (for details, see section ‘Achievement Domains’)</td>
</tr>
<tr class="odd">
<td>grade</td>
<td>Grade of achievement outcome</td>
</tr>
<tr class="even">
<td>study</td>
<td>Large-scale assessment study (and cohort): ‘NEPS-SC2’, ‘NEPS-SC3’, ‘NEPS-SC4’, ‘PISA-I+’, ‘DESI’</td>
</tr>
<tr class="odd">
<td>wave</td>
<td>Wave of large-scale assessment study</td>
</tr>
<tr class="even">
<td>model</td>
<td>Hierarchical structure of specified multilevel model: ‘3l’, ‘2l’</td>
</tr>
<tr class="odd">
<td>icc_l2.est</td>
<td>ICC at the classroom level ρ<sub>L2</sub></td>
</tr>
<tr class="even">
<td>icc_l2.se</td>
<td>SE of ICC at the classroom level <em>SE</em>(ρ<sub>L2</sub>)</td>
</tr>
<tr class="odd">
<td>icc_l3.est</td>
<td>ICC at the school level ρ<sub>L3</sub></td>
</tr>
<tr class="even">
<td>icc_l3.se</td>
<td>SE of ICC at the school level <em>SE</em>(ρ<sub>L3</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l1_pretest.est</td>
<td>Explained variance by a pretest at the student level <em>R</em><sup>2</sup><sub>L1</sub></td>
</tr>
<tr class="even">
<td>r2_l1_pretest.se</td>
<td>SE of explained variance by a pretest at the student level <em>SE</em>(<em>R</em><sup>2</sup><sub>L1</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l2_pretest.est</td>
<td>Explained variance by a pretest at the classroom level <em>R</em><sup>2</sup><sub>L2</sub></td>
</tr>
<tr class="even">
<td>r2_l2_pretest.se</td>
<td>SE of explained variance by a pretest at the classroom level <em>SE</em>(<em>R</em><sup>2</sup><sub>L2</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l3_pretest.est</td>
<td>Explained variance by a pretest at the school level <em>R</em><sup>2</sup><sub>L3</sub></td>
</tr>
<tr class="even">
<td>r2_l3_pretest.se</td>
<td>SE of explained variance by a pretest at the school level <em>SE</em>(<em>R</em><sup>2</sup><sub>L3</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l1_ses.est</td>
<td>Explained variance by sociodemographics at the student level <em>R</em><sup>2</sup><sub>L1</sub></td>
</tr>
<tr class="even">
<td>r2_l1_ses.se</td>
<td>SE of explained variance by sociodemographics at the student level <em>SE</em>(<em>R</em><sup>2</sup><sub>L1</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l2_ses.est</td>
<td>Explained variance by sociodemographics at the classroom level <em>R</em><sup>2</sup><sub>L2</sub></td>
</tr>
<tr class="even">
<td>r2_l2_ses.se</td>
<td>SE of explained variance by sociodemographics at the classroom level <em>SE</em>(<em>R</em><sup>2</sup><sub>L2</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l3_ses.est</td>
<td>Explained variance by sociodemographics at the school level <em>R</em><sup>2</sup><sub>L3</sub></td>
</tr>
<tr class="even">
<td>r2_l3_ses.se</td>
<td>SE of explained variance by sociodemographics at the school level <em>SE</em>(<em>R</em><sup>2</sup><sub>L3</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l1_pretestses.est</td>
<td>Explained variance by a pretest and sociodemographics at the student level <em>R</em><sup>2</sup><sub>L1</sub></td>
</tr>
<tr class="even">
<td>r2_l1_pretestses.se</td>
<td>SE of explained variance by a pretest and sociodemographics at the student level <em>SE</em>(<em>R</em><sup>2</sup><sub>L1</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l2_pretestses.est</td>
<td>Explained variance by a pretest and sociodemographics at the classroom level <em>R</em><sup>2</sup><sub>L2</sub></td>
</tr>
<tr class="even">
<td>r2_l2_pretestses.se</td>
<td>SE of explained variance by a pretest and sociodemographics at the classroom level <em>SE</em>(<em>R</em><sup>2</sup><sub>L2</sub>)</td>
</tr>
<tr class="odd">
<td>r2_l3_pretestses.est</td>
<td>Explained variance by a pretest and sociodemographics at the school level <em>R</em><sup>2</sup><sub>L3</sub></td>
</tr>
<tr class="even">
<td>r2_l3_pretestses.se</td>
<td>SE of explained variance by a pretest and sociodemographics at the school level <em>SE</em>(<em>R</em><sup>2</sup><sub>L3</sub>)</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Data frames that contain normative distributions (i.e., B2, B4, B6, B8, B10, B12, B14, and B16) are structured as follows.</p>
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>domain</td>
<td>Domain of summarized parameters (for details, see section ‘Achievement Domains’)</td>
</tr>
<tr class="even">
<td>grade_range</td>
<td>Grade range of summarized parameters</td>
</tr>
<tr class="odd">
<td>statistic</td>
<td>Summary statistic: ‘Minimum’, ‘25th Percentile’, ‘Median’, ‘75th Percentile’, ‘Maximum’</td>
</tr>
<tr class="even">
<td>icc_l2.est</td>
<td>ICC at the classroom level ρ<sub>L2</sub></td>
</tr>
<tr class="odd">
<td>icc_l2.se</td>
<td>SE of ICC at the classroom level <em>SE</em>(ρ<sub>L2</sub>)</td>
</tr>
<tr class="even">
<td>icc_l3.est</td>
<td>ICC at the school level ρ<sub>L3</sub></td>
</tr>
<tr class="odd">
<td>icc_l3.se</td>
<td>SE of ICC at the school level <em>SE</em>(ρ<sub>L3</sub>)</td>
</tr>
<tr class="even">
<td>r2_l1_pretest.est</td>
<td>Explained variance by a pretest at the student level <em>R</em><sup>2</sup><sub>L1</sub></td>
</tr>
<tr class="odd">
<td>r2_l1_pretest.se</td>
<td>SE of explained variance by a pretest at the student level <em>SE</em>(<em>R</em><sup>2</sup><sub>L1</sub>)</td>
</tr>
<tr class="even">
<td>r2_l2_pretest.est</td>
<td>Explained variance by a pretest at the classroom level <em>R</em><sup>2</sup><sub>L2</sub></td>
</tr>
<tr class="odd">
<td>r2_l2_pretest.se</td>
<td>SE of explained variance by a pretest at the classroom level <em>SE</em>(<em>R</em><sup>2</sup><sub>L2</sub>)</td>
</tr>
<tr class="even">
<td>r2_l3_pretest.est</td>
<td>Explained variance by a pretest at the school level <em>R</em><sup>2</sup><sub>L3</sub></td>
</tr>
<tr class="odd">
<td>r2_l3_pretest.se</td>
<td>SE of explained variance by a pretest at the school level <em>SE</em>(<em>R</em><sup>2</sup><sub>L3</sub>)</td>
</tr>
<tr class="even">
<td>r2_l1_ses.est</td>
<td>Explained variance by sociodemographics at the student level <em>R</em><sup>2</sup><sub>L1</sub></td>
</tr>
<tr class="odd">
<td>r2_l1_ses.se</td>
<td>SE of explained variance by sociodemographics at the student level <em>SE</em>(<em>R</em><sup>2</sup><sub>L1</sub>)</td>
</tr>
<tr class="even">
<td>r2_l2_ses.est</td>
<td>Explained variance by sociodemographics at the classroom level <em>R</em><sup>2</sup><sub>L2</sub></td>
</tr>
<tr class="odd">
<td>r2_l2_ses.se</td>
<td>SE of explained variance by sociodemographics at the classroom level <em>SE</em>(<em>R</em><sup>2</sup><sub>L2</sub>)</td>
</tr>
<tr class="even">
<td>r2_l3_ses.est</td>
<td>Explained variance by sociodemographics at the school level <em>R</em><sup>2</sup><sub>L3</sub></td>
</tr>
<tr class="odd">
<td>r2_l3_ses.se</td>
<td>SE of explained variance by sociodemographics at the school level <em>SE</em>(<em>R</em><sup>2</sup><sub>L3</sub>)</td>
</tr>
<tr class="even">
<td>r2_l1_pretestses.est</td>
<td>Explained variance by a pretest and sociodemographics at the student level <em>R</em><sup>2</sup><sub>L1</sub></td>
</tr>
<tr class="odd">
<td>r2_l1_pretestses.se</td>
<td>SE of explained variance by a pretest and sociodemographics at the student level <em>SE</em>(<em>R</em><sup>2</sup><sub>L1</sub>)</td>
</tr>
<tr class="even">
<td>r2_l2_pretestses.est</td>
<td>Explained variance by a pretest and sociodemographics at the classroom level <em>R</em><sup>2</sup><sub>L2</sub></td>
</tr>
<tr class="odd">
<td>r2_l2_pretestses.se</td>
<td>SE of explained variance by a pretest and sociodemographics at the classroom level <em>SE</em>(<em>R</em><sup>2</sup><sub>L2</sub>)</td>
</tr>
<tr class="even">
<td>r2_l3_pretestses.est</td>
<td>Explained variance by a pretest and sociodemographics at the school level <em>R</em><sup>2</sup><sub>L3</sub></td>
</tr>
<tr class="odd">
<td>r2_l3_pretestses.se</td>
<td>SE of explained variance by a pretest and sociodemographics at the school level <em>SE</em>(<em>R</em><sup>2</sup><sub>L3</sub>)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Note that three-level design parameters (students at L1 within classrooms at L2 within schools at L3) were estimated for grades 1 to 10 only. For grades 11 to 12, no L2 estimates are available as 11th and 12th graders did not attend intact classrooms, but rather the grouping of students varied depending on the subject taught. Therefore, two-level design parameters (students at L1 within schools at L3) were estimated instead. Two-level equivalents for grades 1 to 10 (i.e., ignoring classroom-level clustering) are also provided; you can access them in the data frames labeled with ‘-2l’.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keep in mind that the top level (which is always the school level) is consistently indicated as ‘_l3’ across all data frames; irrespective of whether L2 estimates were estimated (i.e., also for two-level designs).</p>
</div>
</div>
<p>Detailed information on the provided design parameters and underlying analysis models can be retrieved from <span class="citation" data-cites="stallasch2021">Stallasch et al. (<a href="#ref-stallasch2021" role="doc-biblioref">2021</a>)</span>.</p>
</section>
<section id="achievement-domains" class="level4">
<h4 class="anchored" data-anchor-id="achievement-domains">Achievement Domains</h4>
<p>The design parameters cover the following achievement domains.</p>
<p>Note that the (sub)domain character strings in the data frames are named exactly like shown here. For instance, if we want to filter design parameters for English text reconstruction from data frame B1, we could use the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PowerUpR)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter English text reconstruction from data frame B1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>eng_ctest <span class="ot">&lt;-</span> multides1[[<span class="st">"B1_General"</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(domain <span class="sc">==</span> <span class="st">"Verbal Skills in English (as Foreign Language)"</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         subdomain <span class="sc">==</span> <span class="st">"Text Reconstruction (C-Test)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Tip</strong>: However, avoid to type the full strings. We recommend using pattern matching functions like from the <code>grep()</code> family instead that will do the job for you.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># better:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>eng_ctest <span class="ot">&lt;-</span> multides1[[<span class="st">"B1_General"</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Eng"</span>, domain), </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">grepl</span>(<span class="st">"C-Test"</span>, subdomain))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s have a look at the filtered design parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>eng_ctest <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="co"># transpose for better readability</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  kbl <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"condensed"</span>, <span class="st">"responsive"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">"350px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:350px; ">
<div class="table-responsive">
<table class="table table-condensed table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;">domain</td>
<td style="text-align: left;">Verbal Skills in English (as Foreign Language)</td>
<td style="text-align: left;">Verbal Skills in English (as Foreign Language)</td>
<td style="text-align: left;">Verbal Skills in English (as Foreign Language)</td>
</tr>
<tr class="even">
<td style="text-align: left;">subdomain</td>
<td style="text-align: left;">Text Reconstruction (C-Test)</td>
<td style="text-align: left;">Text Reconstruction (C-Test)</td>
<td style="text-align: left;">Text Reconstruction (C-Test)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grade</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">study</td>
<td style="text-align: left;">DESI</td>
<td style="text-align: left;">DESI</td>
<td style="text-align: left;">DESI (Pooled)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wave</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">model</td>
<td style="text-align: left;">3l</td>
<td style="text-align: left;">3l</td>
<td style="text-align: left;">3l</td>
</tr>
<tr class="odd">
<td style="text-align: left;">icc_l2.est</td>
<td style="text-align: left;">0.07484727</td>
<td style="text-align: left;">0.09329552</td>
<td style="text-align: left;">0.08274759</td>
</tr>
<tr class="even">
<td style="text-align: left;">icc_l2.se</td>
<td style="text-align: left;">0.009634811</td>
<td style="text-align: left;">0.011132797</td>
<td style="text-align: left;">0.007285329</td>
</tr>
<tr class="odd">
<td style="text-align: left;">icc_l3.est</td>
<td style="text-align: left;">0.5839861</td>
<td style="text-align: left;">0.5519840</td>
<td style="text-align: left;">0.5687772</td>
</tr>
<tr class="even">
<td style="text-align: left;">icc_l3.se</td>
<td style="text-align: left;">0.01762045</td>
<td style="text-align: left;">0.01851544</td>
<td style="text-align: left;">0.01276421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l1_pretest.est</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.4270869</td>
<td style="text-align: left;">0.4270869</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l1_pretest.se</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.007683032</td>
<td style="text-align: left;">0.007683032</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l2_pretest.est</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.8440895</td>
<td style="text-align: left;">0.8440895</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l2_pretest.se</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.01575307</td>
<td style="text-align: left;">0.01575307</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l3_pretest.est</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.998872</td>
<td style="text-align: left;">0.998872</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l3_pretest.se</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.0006166911</td>
<td style="text-align: left;">0.0006166911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l1_ses.est</td>
<td style="text-align: left;">0.01315652</td>
<td style="text-align: left;">0.01675238</td>
<td style="text-align: left;">0.01483982</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l1_ses.se</td>
<td style="text-align: left;">0.002402910</td>
<td style="text-align: left;">0.002561325</td>
<td style="text-align: left;">0.001752443</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l2_ses.est</td>
<td style="text-align: left;">0.6742777</td>
<td style="text-align: left;">0.6423608</td>
<td style="text-align: left;">0.6577857</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l2_ses.se</td>
<td style="text-align: left;">0.09820881</td>
<td style="text-align: left;">0.09497836</td>
<td style="text-align: left;">0.06827333</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l3_ses.est</td>
<td style="text-align: left;">0.8845148</td>
<td style="text-align: left;">0.9068157</td>
<td style="text-align: left;">0.8968653</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l3_ses.se</td>
<td style="text-align: left;">0.01972262</td>
<td style="text-align: left;">0.01770283</td>
<td style="text-align: left;">0.01317418</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l1_pretestses.est</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.4306028</td>
<td style="text-align: left;">0.4306028</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l1_pretestses.se</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.007663661</td>
<td style="text-align: left;">0.007663661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l2_pretestses.est</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.8838199</td>
<td style="text-align: left;">0.8838199</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l2_pretestses.se</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.01990558</td>
<td style="text-align: left;">0.01990558</td>
</tr>
<tr class="odd">
<td style="text-align: left;">r2_l3_pretestses.est</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.9993725</td>
<td style="text-align: left;">0.9993725</td>
</tr>
<tr class="even">
<td style="text-align: left;">r2_l3_pretestses.se</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.000219044</td>
<td style="text-align: left;">0.000219044</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</div>
<p>&nbsp;<br>
As can be seen, there are three entries for English text reconstruction as the respective test was administered to students at two time points in the DESI study, namely at the beginning and at the end of grade 9. For the beginning of grade 9, no pretests were available, therefore the corresponding cells are set to <code>NA</code>. A third set of estimates is provided here that contains the meta-analytically pooled results across these two time points (as indicated by ‘DESI (Pooled)’). Note that this integration strategy (applying a fixed effect model approach) was also adopted for other domains in grade 9 in case multiple design parameters were available (as obtained either from several studies [as indicated by ‘All (Pooled)’] or from the two time points in DESI).</p>
<p>Load the design parameter collection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"C:/Users/Sophie Stallasch/Documents/Workshops/2024_GEBF_Poweranalyse_Stallasch/2024-workshop-GEBF-power/multides1.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="scenario-1-how-many-schools-are-required-for-a-2l-crt" class="level2">
<h2 class="anchored" data-anchor-id="scenario-1-how-many-schools-are-required-for-a-2l-crt">Scenario 1: How Many Schools are Required for a 2L-CRT?</h2>
<p>Research Team 1 would like to conduct a 2L-CRT on the effectiveness of a school-wide intervention to improve 4th graders’ mathematical achievement in Germany. Team 1 plans to sample 40 students from each school. A standardized treatment effect of <em>d</em> = .25 is considered meaningful, because it represents around one quarter of the expected annual growth in mathematics from Grade 3 to Grade 4 in the German student population <span class="citation" data-cites="brunner2023">(<a href="#ref-brunner2023" role="doc-biblioref">Brunner et al., 2023</a>, Table 1)</span>. How many schools are required to detect <em>MDES</em> = .25?</p>
<section id="step-1-choose-the-design-parameters" class="level3">
<h3 class="anchored" data-anchor-id="step-1-choose-the-design-parameters">Step 1: Choose the Design Parameters</h3>
<p>Which data frame contains the appropriate design parameters?</p>
<p><img src="img/crt_s1.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- choose data frame B9 </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dp_s1 <span class="ot">&lt;-</span> multides1[[<span class="st">"B9_General-2l"</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter mathematics in grade 4</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(domain <span class="sc">==</span> <span class="st">"Mathematics"</span>, grade <span class="sc">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s have a look at the relevant design parameters.</p>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dp_s1 <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the ICC and its standard error</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"icc"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">icc_l3.est</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">icc_l3.se</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="step-2-define-the-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="step-2-define-the-assumptions">Step 2: Define the Assumptions</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Design Assumptions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Formula</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<table class="table">
<colgroup>
<col style="width: 66%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>PowerUpR Conversion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Target output</strong></td>
<td></td>
</tr>
<tr class="even">
<td>Minimum required sample size of a 2L-CRT: Number of schools <em>J</em></td>
<td><code>mrss.cra2()</code></td>
</tr>
<tr class="odd">
<td><strong>Statistical test</strong></td>
<td></td>
</tr>
<tr class="even">
<td>Power 1-β = .80</td>
<td><code>power=.80</code> (default)</td>
</tr>
<tr class="odd">
<td>Significance level α = .05</td>
<td><code>alpha=.05</code> (default)</td>
</tr>
<tr class="even">
<td>Two-tailed test</td>
<td><code>two.tailed=TRUE</code> (default)</td>
</tr>
<tr class="odd">
<td><strong>Sample sizes</strong></td>
<td></td>
</tr>
<tr class="even">
<td>Harmonic mean number of L1 units per L2 unit <em>n</em> = 40</td>
<td><code>n=40</code></td>
</tr>
<tr class="odd">
<td>Proportion of sample assigned to treatment <em>P</em> = .50 (balanced)</td>
<td><code>p=.50</code> (default)</td>
</tr>
<tr class="even">
<td><strong>Design parameters</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>ICC at L2 ρ<sub>L2</sub> = .12</td>
<td><code>rho2=dp_s1$icc_l3.est</code></td>
</tr>
<tr class="even">
<td><strong>Further parameters</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>Minimum detectable effect size <em>MDES</em> = .25</td>
<td><code>es=.25</code></td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Based on the expression for the <em>MDES</em> of a 2L-CRT with randomization/treatment assignment at L2 as given in <span class="citation" data-cites="dong_maynard2013">(<a href="#ref-dong_maynard2013" role="doc-biblioref"><strong>dong_maynard2013?</strong></a>)</span>, the number of schools <span class="math inline">\(J\)</span> is computed as <span class="math display">\[
J = \left(\frac{M_{J-2}}{MDES}\right)^2\left(\frac{\rho_{L2}}{P(1-P)}+\frac{(1-\rho_{L2})}{P(1-P)n} \right)
\]</span> with</p>
<ul>
<li><span class="math inline">\(n\)</span> = harmonic mean number of L1 units per L2 unit</li>
<li><span class="math inline">\(J\)</span> = number of L2 units</li>
<li><span class="math inline">\(P\)</span> = <span class="math inline">\(J_{TG}/J\)</span> = proportion of sample assigned to treatment</li>
<li><span class="math inline">\(MDES\)</span> = minimum detectable effect size</li>
<li><span class="math inline">\(M_{J-2}\)</span> = <span class="math inline">\(t_{\alpha/2}+t_{1-\beta}\)</span> = multiplier for two-tailed test with <span class="math inline">\(J-2\)</span> degrees of freedom</li>
<li><span class="math inline">\(\rho_{L2}\)</span> = achievement differences at L2 (ICC at L2)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="step-3-power-analysis-with-powerupr" class="level3">
<h3 class="anchored" data-anchor-id="step-3-power-analysis-with-powerupr">Step 3: Power Analysis with PowerUpR</h3>
<section id="simple-design-with-default-assumptions" class="level4">
<h4 class="anchored" data-anchor-id="simple-design-with-default-assumptions">Simple Design with Default Assumptions</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">power=</span>.<span class="dv">80</span>, <span class="at">alpha=</span>.<span class="dv">05</span>, <span class="at">two.tailed=</span><span class="cn">TRUE</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">p=</span>.<span class="dv">50</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 73 </code></pre>
</div>
</div>
<p>Given this design, at least 73 schools are necessary to detect an <em>MDES</em> of .25.</p>
<p>Of course, it is also possible to directly insert the numeric values for the design parameters, but using the variables instead is safer, more precise, and prevents typos. Note that the results can differ due to rounding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Here, we are omitting all default parameters...</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.01</span> <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>.<span class="dv">12</span>, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 73 </code></pre>
</div>
</div>
</section>
<section id="changing-the-default-assumptions" class="level4">
<h4 class="anchored" data-anchor-id="changing-the-default-assumptions">Changing the Default Assumptions</h4>
<p>Everything else being equal, what happens, when…</p>
<section id="a-power-increases-from-80-to-90" class="level5">
<h5 class="anchored" data-anchor-id="a-power-increases-from-80-to-90">(a) … power increases from 80% to 90%?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `power` argument to .90</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>d.a <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">power=</span>.<span class="dv">90</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 97 </code></pre>
</div>
</div>
<p>Increasing power requires a larger number of schools.</p>
<p><strong>Tip</strong>: We could also update the respective parameter in the list <code>$parms</code> stored in the <code>mrss</code> object and then call the function again with the modified argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save design 0 as a new design</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>d.a <span class="ot">&lt;-</span> d<span class="fl">.0</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># update `power` argument to .90</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>d.a<span class="sc">$</span>parms<span class="sc">$</span>power<span class="ot">=</span>.<span class="dv">90</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># call the function</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>d.a <span class="ot">&lt;-</span> <span class="fu">exec</span>(<span class="st">"mrss.cra2"</span>, <span class="sc">!!!</span>d.a<span class="sc">$</span>parms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 97 </code></pre>
</div>
</div>
</section>
<section id="b-type-i-error-rate-is-set-to-1" class="level5">
<h5 class="anchored" data-anchor-id="b-type-i-error-rate-is-set-to-1">(b) … Type I error rate is set to 1%?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `alpha` argument to .01</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>d.b <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">alpha=</span>.<span class="dv">01</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 109 </code></pre>
</div>
</div>
<p>Decreasing the Type I error rate requires a larger number of schools.</p>
</section>
<section id="c-applying-a-one-tailed-test" class="level5">
<h5 class="anchored" data-anchor-id="c-applying-a-one-tailed-test">(c) … applying a one-tailed test?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `two.tailed` argument to FALSE</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>d.c <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">two.tailed=</span><span class="cn">FALSE</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 57 </code></pre>
</div>
</div>
<p>Testing one-tailed requires a smaller number of schools.</p>
</section>
<section id="d-sampling-20406080100-students-per-school" class="level5">
<h5 class="anchored" data-anchor-id="d-sampling-20406080100-students-per-school">(d) … sampling 20/40/60/80/100 students per school?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `n` argument to 20/40/60/80/100</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>d.d1 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>d.d2 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>d.d3 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">60</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>d.d4 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">80</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>d.d5 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Tip</strong>: Performing power analysis over a range of possible input parameters can be more easily done via vectorization. To vectorize the functions of <code>PowerUpR</code> over a range of possible input parameters (here: n = 20/40/60/80/100), we need to write a custom function similar to what is suggested by the package authors in their <a href="https://cran.r-project.org/web/packages/PowerUpR/vignettes/vectorization_over_arbitary_parameters.html">vignette on vectorization</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>custom_mrss.cra2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  parms <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n=</span>n, <span class="at">rho2 =</span> dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  design <span class="ot">&lt;-</span> <span class="fu">exec</span>(<span class="st">"mrss.cra2"</span>, <span class="sc">!!!</span>parms)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  design<span class="sc">$</span>J</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we simply have to map the function across the various sample sizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of students per school n = 20/40/60/80/100 </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">20</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>d.d <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(n, custom_mrss.cra2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 84 
J = 73 
J = 69 
J = 67 
J = 66 </code></pre>
</div>
</div>
<p>Sampling fewer/more students per school requires a larger/smaller number of schools. However, it becomes clear that increasing the number of students per school quickly reaches a point of diminishing returns.</p>
</section>
<section id="e-using-an-unbalanced-design-with-75-of-the-sample-assigned-to-the-treatment-condition" class="level5">
<h5 class="anchored" data-anchor-id="e-using-an-unbalanced-design-with-75-of-the-sample-assigned-to-the-treatment-condition">(e) … using an unbalanced design with 75% of the sample assigned to the treatment condition?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `p` argument to .75</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>d.e <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">p=</span>.<span class="dv">75</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 111 </code></pre>
</div>
</div>
<p>The more pronounced the imbalance between experimental conditions, the larger the required number of schools.</p>
</section>
<section id="f-larger-achievement-differences-of-rho-.20-are-assumed" class="level5">
<h5 class="anchored" data-anchor-id="f-larger-achievement-differences-of-rho-.20-are-assumed">(f) … larger achievement differences of <span class="math inline">\(\rho\)</span> = .20 are assumed?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust `rho2` to .20</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>d.f <span class="ot">&lt;-</span><span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>.<span class="dv">20</span>, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 112 </code></pre>
</div>
</div>
<p>Larger ICCs increase the required number of schools.</p>
</section>
</section>
<section id="incorporating-statistical-uncertainty" class="level4">
<h4 class="anchored" data-anchor-id="incorporating-statistical-uncertainty">Incorporating Statistical Uncertainty</h4>
<p>The design parameters are estimates of population quantities, and thus, associated with statistical uncertainty. The uncertainty can be incorporated by using the standard errors for each design parameter. Assuming large-sample properties, research Team 1 uses the standard normal distribution to compute the limits for 95% confidence intervals by means of the standard errors for the design parameters. This approach has been labeled the the “safeguard” approach <span class="citation" data-cites="perugini2014">(<a href="#ref-perugini2014" role="doc-biblioref">Perugini et al., 2014</a>)</span>. A conservative approach for planning the sample size is to use the upper bound estimate of the 95% CI for <span class="math inline">\(\rho\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lower bound</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>d.g_lb <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rho2 =</span> dp_s1<span class="sc">$</span>icc_l3.est<span class="fl">-1.96</span><span class="sc">*</span>dp_s1<span class="sc">$</span>icc_l3.se, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 61 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upper bound</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>d.g_ub <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rho2 =</span> dp_s1<span class="sc">$</span>icc_l3.est<span class="fl">+1.96</span><span class="sc">*</span>dp_s1<span class="sc">$</span>icc_l3.se, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 85 </code></pre>
</div>
</div>
<p>Taking statistical uncertainty into account, the required number of schools likely ranges between 61 and 85.</p>
<p>Note that there are also other approaches to tackle uncertainties and/or heterogeneities in the input parameters. For instance, (Bayesian) simulation-based approaches to power analysis have been proposed that implicitly take into account uncertainty<span class="citation" data-cites="moerbeek2015 pek2019 spiegelhalter2003 turner2004">(see e.g., <a href="#ref-moerbeek2015" role="doc-biblioref">Moerbeek &amp; Teerenstra, 2015</a>; <a href="#ref-pek2019" role="doc-biblioref">Pek &amp; Park, 2019</a>; <a href="#ref-spiegelhalter2003" role="doc-biblioref">Spiegelhalter et al., 2003</a>; <a href="#ref-turner2004" role="doc-biblioref">Turner et al., 2004</a>)</span>.</p>
</section>
</section>
<section id="step-4-plotting" class="level3">
<h3 class="anchored" data-anchor-id="step-4-plotting">Step 4: Plotting</h3>
<p>Let’s plot the results. Move your cursor across the bars to learn about the required number schools for each design and how large the difference in % is compared to the baseline design.</p>
<details>
<summary>
show code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"plotly"</span>, <span class="st">"htmlwidgets"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(packages,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>         <span class="cf">function</span>(x) {</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>           <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">install.packages</span>(x, <span class="at">dependencies =</span> <span class="cn">TRUE</span>); <span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">list</span>(d<span class="fl">.0</span>, d.a, d.b, d.c, d.d1, d.d3, d.d5, d.e, d.f, d.g_lb, d.g_ub) <span class="sc">|&gt;</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">"d.0"</span>, <span class="st">"d.a"</span>, <span class="st">"d.b"</span>, <span class="st">"d.c"</span>, <span class="st">"d.d1"</span>, <span class="st">"d.d3"</span>, <span class="st">"d.d5"</span>, <span class="st">"d.e"</span>, <span class="st">"d.f"</span>, <span class="st">"d.g_lb"</span>, <span class="st">"d.g_ub"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="cf">function</span>(design) (design[[<span class="st">"J"</span>]]<span class="sc">-</span>d<span class="fl">.0</span>[[<span class="st">"J"</span>]])<span class="sc">/</span>d<span class="fl">.0</span>[[<span class="st">"J"</span>]]<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">design =</span> <span class="fu">factor</span>(<span class="fu">names</span>(design)), </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">schools =</span> <span class="fu">map_dbl</span>(design, <span class="sc">~</span>.[[<span class="st">"J"</span>]]), </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">delta =</span> <span class="fu">map_dbl</span>(design, delta)) <span class="sc">|&gt;</span> </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(design, schools, <span class="at">text =</span> <span class="fu">paste</span>(</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(design, </span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"d.0"</span>, <span class="st">"d.a"</span>, <span class="st">"d.b"</span>, <span class="st">"d.c"</span>, <span class="st">"d.d1"</span>, <span class="st">"d.d3"</span>, <span class="st">"d.d5"</span>, <span class="st">"d.e"</span>, <span class="st">"d.f"</span>, <span class="st">"d.g_lb"</span>, <span class="st">"d.g_ub"</span>), </span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"The baseline design"</span>, </span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... increasing power to 90%"</span>, </span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" ... setting Type I error rate to 1%"</span>, </span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" ... applying a one-tailed test"</span>, </span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... sampling 20 students per school"</span>, </span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... sampling 60 students per school"</span>, </span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... sampling 100 students per school"</span>, </span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... assigning 75% of the schools to the treatment condition"</span>, </span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... assuming increased achievement differences at L2 of 20%"</span>, </span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... applying a liberal approach"</span>,</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... applying a conservative approach"</span>)),</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">" requires J = "</span>, schools, <span class="st">" schools."</span>,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(design <span class="sc">==</span> <span class="st">"d.0"</span>, <span class="st">""</span>, </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(design <span class="sc">!=</span> <span class="st">"d.0"</span> <span class="sc">&amp;</span> delta <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste0</span>(<span class="st">"This amounts to "</span>, <span class="fu">round</span>(delta, <span class="dv">0</span>), </span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"% more schools compared to the baseline design."</span>),</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(design <span class="sc">!=</span> <span class="st">"d.0"</span> <span class="sc">&amp;</span> delta <span class="sc">==</span> <span class="dv">0</span>, </span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The required number of schools does not change compared to the baseline design."</span>,</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste0</span>(<span class="st">"This amounts to "</span>, <span class="fu">round</span>(delta, <span class="dv">0</span>)<span class="sc">*-</span><span class="dv">1</span>, </span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"% fewer schools compared to the baseline design."</span>)))),</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>    ))) <span class="sc">+</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">width=</span><span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"Design"</span>) <span class="sc">+</span> </span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Number of schools"</span>) <span class="sc">+</span> </span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Number of Schools Required for an MDES of .25 by Design"</span>)</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-18cfc31be4199a408b78" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-18cfc31be4199a408b78">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[73,97,109,57,84,69,66,111,112,61,85],"text":["The baseline design requires J = 73 schools.<br />","... increasing power to 90% requires J = 97 schools.<br />This amounts to 33% more schools compared to the baseline design."," ... setting Type I error rate to 1% requires J = 109 schools.<br />This amounts to 49% more schools compared to the baseline design."," ... applying a one-tailed test requires J = 57 schools.<br />This amounts to 22% fewer schools compared to the baseline design.","... sampling 20 students per school requires J = 84 schools.<br />This amounts to 15% more schools compared to the baseline design.","... sampling 60 students per school requires J = 69 schools.<br />This amounts to 5% fewer schools compared to the baseline design.","... sampling 100 students per school requires J = 66 schools.<br />This amounts to 10% fewer schools compared to the baseline design.","... assigning 75% of the schools to the treatment condition requires J = 111 schools.<br />This amounts to 52% more schools compared to the baseline design.","... assuming increased achievement differences at L2 of 20% requires J = 112 schools.<br />This amounts to 53% more schools compared to the baseline design.","... applying a liberal approach requires J = 61 schools.<br />This amounts to 16% fewer schools compared to the baseline design.","... applying a conservative approach requires J = 85 schools.<br />This amounts to 16% more schools compared to the baseline design."],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Number of Schools Required for an MDES of .25 by Design","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,11.6],"tickmode":"array","ticktext":["d.0","d.a","d.b","d.c","d.d1","d.d3","d.d5","d.e","d.f","d.g_lb","d.g_ub"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11],"categoryorder":"array","categoryarray":["d.0","d.a","d.b","d.c","d.d1","d.d3","d.d5","d.e","d.f","d.g_lb","d.g_ub"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Design","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.6000000000000005,117.59999999999999],"tickmode":"array","ticktext":["0","30","60","90"],"tickvals":[0,30,59.999999999999993,90],"categoryorder":"array","categoryarray":["0","30","60","90"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Number of schools","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"dcc21366d57":{"x":{},"y":{},"text":{},"type":"bar"}},"cur_data":"dcc21366d57","visdat":{"dcc21366d57":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="built-in-functionality-for-plotting-in-powerupr" class="level4">
<h4 class="anchored" data-anchor-id="built-in-functionality-for-plotting-in-powerupr">Built-in Functionality for Plotting in PowerUpR</h4>
<p>PowerUpR also comes with a built-in plotting function. We will quickly check out <code>PowerUpR::plot()</code> with the baseline design.</p>
<p>It is not possible to plot the required sample size. Instead, we can either plot the statistical power as a function of the sample size (which is the default)…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="fl">.0</span>, <span class="at">main =</span> <span class="st">"Power as a Function of the Number of Schools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="covariates_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>… or we can plot the <em>MDES</em> along with its (1-α)*100% CI as a function of the required number of schools.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># include `ypar = "mdes"` to plot the MDES</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># include `locate=TRUE` to locate parameter values for the applied design</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="fl">.0</span>, <span class="at">ypar =</span> <span class="st">"mdes"</span>, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MDES as a Function of Number of Schools"</span>, <span class="at">locate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="covariates_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="scenario-2-how-many-schools-are-required-for-a-2l-crt" class="level2">
<h2 class="anchored" data-anchor-id="scenario-2-how-many-schools-are-required-for-a-2l-crt">Scenario 2: How Many Schools are Required for a 2L-CRT?</h2>
<p>Research Team 1 would like to conduct a 2L-CRT on the effectiveness of a school-wide intervention to improve 4th graders’ mathematical achievement in Germany. Team 1 plans to sample 40 students from each school. A standardized treatment effect of <em>d</em> = .25 is considered meaningful, because it represents around one quarter of the expected annual growth in mathematics from Grade 3 to Grade 4 in the German student population <span class="citation" data-cites="brunner2023">(<a href="#ref-brunner2023" role="doc-biblioref">Brunner et al., 2023</a>, Table 1)</span>. How many schools are required to detect <em>MDES</em> = .25?</p>
<section id="step-1-choose-the-design-parameters-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-choose-the-design-parameters-1">Step 1: Choose the Design Parameters</h3>
<p>Which data frame contains the appropriate design parameters?</p>
<p><img src="img/crt_s1.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- choose data frame B9 </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>dp_s1 <span class="ot">&lt;-</span> multides1[[<span class="st">"B9_General-2l"</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter mathematics in grade 4</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(domain <span class="sc">==</span> <span class="st">"Mathematics"</span>, grade <span class="sc">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s have a look at the relevant design parameters.</p>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dp_s1 <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select the ICC and its standard error</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"icc"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Variable"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">icc_l3.est</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">icc_l3.se</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="step-2-define-the-assumptions-1" class="level3">
<h3 class="anchored" data-anchor-id="step-2-define-the-assumptions-1">Step 2: Define the Assumptions</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Design Assumptions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Formula</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<table class="table">
<colgroup>
<col style="width: 66%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>PowerUpR Conversion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Target output</strong></td>
<td></td>
</tr>
<tr class="even">
<td>Minimum required sample size of a 2L-CRT: Number of schools <em>J</em></td>
<td><code>mrss.cra2()</code></td>
</tr>
<tr class="odd">
<td><strong>Statistical test</strong></td>
<td></td>
</tr>
<tr class="even">
<td>Power 1-β = .80</td>
<td><code>power=.80</code> (default)</td>
</tr>
<tr class="odd">
<td>Significance level α = .05</td>
<td><code>alpha=.05</code> (default)</td>
</tr>
<tr class="even">
<td>Two-tailed test</td>
<td><code>two.tailed=TRUE</code> (default)</td>
</tr>
<tr class="odd">
<td><strong>Sample sizes</strong></td>
<td></td>
</tr>
<tr class="even">
<td>Harmonic mean number of L1 units per L2 unit <em>n</em> = 40</td>
<td><code>n=40</code></td>
</tr>
<tr class="odd">
<td>Proportion of sample assigned to treatment <em>P</em> = .50 (balanced)</td>
<td><code>p=.50</code> (default)</td>
</tr>
<tr class="even">
<td><strong>Design parameters</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>ICC at L2 ρ<sub>L2</sub> = .12</td>
<td><code>rho2=dp_s1$icc_l3.est</code></td>
</tr>
<tr class="even">
<td><strong>Further parameters</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>Minimum detectable effect size <em>MDES</em> = .25</td>
<td><code>es=.25</code></td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Based on the expression for the <em>MDES</em> of a 2L-CRT with randomization/treatment assignment at L2 as given in <span class="citation" data-cites="dong_maynard2013">(<a href="#ref-dong_maynard2013" role="doc-biblioref"><strong>dong_maynard2013?</strong></a>)</span>, the number of schools <span class="math inline">\(J\)</span> is computed as <span class="math display">\[
J = \left(\frac{M_{J-2}}{MDES}\right)^2\left(\frac{\rho_{L2}}{P(1-P)}+\frac{(1-\rho_{L2})}{P(1-P)n} \right)
\]</span> with</p>
<ul>
<li><span class="math inline">\(n\)</span> = harmonic mean number of L1 units per L2 unit</li>
<li><span class="math inline">\(J\)</span> = number of L2 units</li>
<li><span class="math inline">\(P\)</span> = <span class="math inline">\(J_{TG}/J\)</span> = proportion of sample assigned to treatment</li>
<li><span class="math inline">\(MDES\)</span> = minimum detectable effect size</li>
<li><span class="math inline">\(M_{J-2}\)</span> = <span class="math inline">\(t_{\alpha/2}+t_{1-\beta}\)</span> = multiplier for two-tailed test with <span class="math inline">\(J-2\)</span> degrees of freedom</li>
<li><span class="math inline">\(\rho_{L2}\)</span> = achievement differences at L2 (ICC at L2)</li>
</ul>
</div>
</div>
</div>
</section>
<section id="step-3-power-analysis-with-powerupr-1" class="level3">
<h3 class="anchored" data-anchor-id="step-3-power-analysis-with-powerupr-1">Step 3: Power Analysis with PowerUpR</h3>
<section id="simple-design-with-default-assumptions-1" class="level4">
<h4 class="anchored" data-anchor-id="simple-design-with-default-assumptions-1">Simple Design with Default Assumptions</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">power=</span>.<span class="dv">80</span>, <span class="at">alpha=</span>.<span class="dv">05</span>, <span class="at">two.tailed=</span><span class="cn">TRUE</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">p=</span>.<span class="dv">50</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 73 </code></pre>
</div>
</div>
<p>Given this design, at least 73 schools are necessary to detect an <em>MDES</em> of .25.</p>
<p>Of course, it is also possible to directly insert the numeric values for the design parameters, but using the variables instead is safer, more precise, and prevents typos. Note that the results can differ due to rounding.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Here, we are omitting all default parameters...</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.01</span> <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>.<span class="dv">12</span>, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 73 </code></pre>
</div>
</div>
</section>
<section id="changing-the-default-assumptions-1" class="level4">
<h4 class="anchored" data-anchor-id="changing-the-default-assumptions-1">Changing the Default Assumptions</h4>
<p>Everything else being equal, what happens, when…</p>
<section id="a-power-increases-from-80-to-90-1" class="level5">
<h5 class="anchored" data-anchor-id="a-power-increases-from-80-to-90-1">(a) … power increases from 80% to 90%?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `power` argument to .90</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>d.a <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">power=</span>.<span class="dv">90</span>, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 97 </code></pre>
</div>
</div>
<p>Increasing power requires a larger number of schools.</p>
<p><strong>Tip</strong>: We could also update the respective parameter in the list <code>$parms</code> stored in the <code>mrss</code> object and then call the function again with the modified argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save design 0 as a new design</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>d.a <span class="ot">&lt;-</span> d<span class="fl">.0</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># update `power` argument to .90</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>d.a<span class="sc">$</span>parms<span class="sc">$</span>power<span class="ot">=</span>.<span class="dv">90</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># call the function</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>d.a <span class="ot">&lt;-</span> <span class="fu">exec</span>(<span class="st">"mrss.cra2"</span>, <span class="sc">!!!</span>d.a<span class="sc">$</span>parms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 97 </code></pre>
</div>
</div>
</section>
<section id="b-type-i-error-rate-is-set-to-1-1" class="level5">
<h5 class="anchored" data-anchor-id="b-type-i-error-rate-is-set-to-1-1">(b) … Type I error rate is set to 1%?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `alpha` argument to .01</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>d.b <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">alpha=</span>.<span class="dv">01</span>, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 109 </code></pre>
</div>
</div>
<p>Decreasing the Type I error rate requires a larger number of schools.</p>
</section>
<section id="c-applying-a-one-tailed-test-1" class="level5">
<h5 class="anchored" data-anchor-id="c-applying-a-one-tailed-test-1">(c) … applying a one-tailed test?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `two.tailed` argument to FALSE</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>d.c <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">two.tailed=</span><span class="cn">FALSE</span>, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 57 </code></pre>
</div>
</div>
<p>Testing one-tailed requires a smaller number of schools.</p>
</section>
<section id="d-sampling-20406080100-students-per-school-1" class="level5">
<h5 class="anchored" data-anchor-id="d-sampling-20406080100-students-per-school-1">(d) … sampling 20/40/60/80/100 students per school?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `n` argument to 20/40/60/80/100</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>d.d1 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>d.d2 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>d.d3 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">60</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>d.d4 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">80</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>d.d5 <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Tip</strong>: Performing power analysis over a range of possible input parameters can be more easily done via vectorization. To vectorize the functions of <code>PowerUpR</code> over a range of possible input parameters (here: n = 20/40/60/80/100), we need to write a custom function similar to what is suggested by the package authors in their <a href="https://cran.r-project.org/web/packages/PowerUpR/vignettes/vectorization_over_arbitary_parameters.html">vignette on vectorization</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>custom_mrss.cra2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  parms <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n=</span>n, <span class="at">rho2 =</span> dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  design <span class="ot">&lt;-</span> <span class="fu">exec</span>(<span class="st">"mrss.cra2"</span>, <span class="sc">!!!</span>parms)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  design<span class="sc">$</span>J</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we simply have to map the function across the various sample sizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of students per school n = 20/40/60/80/100 </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">20</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>d.d <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(n, custom_mrss.cra2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 84 
J = 73 
J = 69 
J = 67 
J = 66 </code></pre>
</div>
</div>
<p>Sampling fewer/more students per school requires a larger/smaller number of schools. However, it becomes clear that increasing the number of students per school quickly reaches a point of diminishing returns.</p>
</section>
<section id="e-using-an-unbalanced-design-with-75-of-the-sample-assigned-to-the-treatment-condition-1" class="level5">
<h5 class="anchored" data-anchor-id="e-using-an-unbalanced-design-with-75-of-the-sample-assigned-to-the-treatment-condition-1">(e) … using an unbalanced design with 75% of the sample assigned to the treatment condition?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust the `p` argument to .75</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>d.e <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">20</span>, <span class="at">p=</span>.<span class="dv">75</span>, <span class="at">rho2=</span>dp_s1<span class="sc">$</span>icc_l3.est, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 111 </code></pre>
</div>
</div>
<p>The more pronounced the imbalance between experimental conditions, the larger the required number of schools.</p>
</section>
<section id="f-larger-achievement-differences-of-rho-.20-are-assumed-1" class="level5">
<h5 class="anchored" data-anchor-id="f-larger-achievement-differences-of-rho-.20-are-assumed-1">(f) … larger achievement differences of <span class="math inline">\(\rho\)</span> = .20 are assumed?</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust `rho2` to .20</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>d.f <span class="ot">&lt;-</span><span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, <span class="at">rho2=</span>.<span class="dv">20</span>, <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 112 </code></pre>
</div>
</div>
<p>Larger ICCs increase the required number of schools.</p>
</section>
</section>
<section id="incorporating-statistical-uncertainty-1" class="level4">
<h4 class="anchored" data-anchor-id="incorporating-statistical-uncertainty-1">Incorporating Statistical Uncertainty</h4>
<p>The design parameters are estimates of population quantities, and thus, associated with statistical uncertainty. The uncertainty can be incorporated by using the standard errors for each design parameter. Assuming large-sample properties, research Team 1 uses the standard normal distribution to compute the limits for 95% confidence intervals by means of the standard errors for the design parameters. This approach has been labeled the the “safeguard” approach <span class="citation" data-cites="perugini2014">(<a href="#ref-perugini2014" role="doc-biblioref">Perugini et al., 2014</a>)</span>. A conservative approach for planning the sample size is to use the upper bound estimate of the 95% CI for <span class="math inline">\(\rho\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lower bound</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>d.g_lb <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rho2 =</span> dp_s1<span class="sc">$</span>icc_l3.est<span class="fl">-1.96</span><span class="sc">*</span>dp_s1<span class="sc">$</span>icc_l3.se, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 61 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upper bound</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>d.g_ub <span class="ot">&lt;-</span> <span class="fu">mrss.cra2</span>(<span class="at">n=</span><span class="dv">40</span>, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rho2 =</span> dp_s1<span class="sc">$</span>icc_l3.est<span class="fl">+1.96</span><span class="sc">*</span>dp_s1<span class="sc">$</span>icc_l3.se, </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">es=</span>.<span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J = 85 </code></pre>
</div>
</div>
<p>Taking statistical uncertainty into account, the required number of schools likely ranges between 61 and 85.</p>
<p>Note that there are also other approaches to tackle uncertainties and/or heterogeneities in the input parameters. For instance, (Bayesian) simulation-based approaches to power analysis have been proposed that implicitly take into account uncertainty<span class="citation" data-cites="moerbeek2015 pek2019 spiegelhalter2003 turner2004">(see e.g., <a href="#ref-moerbeek2015" role="doc-biblioref">Moerbeek &amp; Teerenstra, 2015</a>; <a href="#ref-pek2019" role="doc-biblioref">Pek &amp; Park, 2019</a>; <a href="#ref-spiegelhalter2003" role="doc-biblioref">Spiegelhalter et al., 2003</a>; <a href="#ref-turner2004" role="doc-biblioref">Turner et al., 2004</a>)</span>.</p>
</section>
</section>
<section id="step-4-plotting-1" class="level3">
<h3 class="anchored" data-anchor-id="step-4-plotting-1">Step 4: Plotting</h3>
<p>Let’s plot the results. Move your cursor across the bars to learn about the required number schools for each design and how large the difference in % is compared to the baseline design.</p>
<details>
<summary>
show code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"plotly"</span>, <span class="st">"htmlwidgets"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(packages,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>         <span class="cf">function</span>(x) {</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>           <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">install.packages</span>(x, <span class="at">dependencies =</span> <span class="cn">TRUE</span>); <span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">list</span>(d<span class="fl">.0</span>, d.a, d.b, d.c, d.d1, d.d3, d.d5, d.e, d.f, d.g_lb, d.g_ub) <span class="sc">|&gt;</span> </span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">"d.0"</span>, <span class="st">"d.a"</span>, <span class="st">"d.b"</span>, <span class="st">"d.c"</span>, <span class="st">"d.d1"</span>, <span class="st">"d.d3"</span>, <span class="st">"d.d5"</span>, <span class="st">"d.e"</span>, <span class="st">"d.f"</span>, <span class="st">"d.g_lb"</span>, <span class="st">"d.g_ub"</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="cf">function</span>(design) (design[[<span class="st">"J"</span>]]<span class="sc">-</span>d<span class="fl">.0</span>[[<span class="st">"J"</span>]])<span class="sc">/</span>d<span class="fl">.0</span>[[<span class="st">"J"</span>]]<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">design =</span> <span class="fu">factor</span>(<span class="fu">names</span>(design)), </span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">schools =</span> <span class="fu">map_dbl</span>(design, <span class="sc">~</span>.[[<span class="st">"J"</span>]]), </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">delta =</span> <span class="fu">map_dbl</span>(design, delta)) <span class="sc">|&gt;</span> </span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(design, schools, <span class="at">text =</span> <span class="fu">paste</span>(</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(design, </span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"d.0"</span>, <span class="st">"d.a"</span>, <span class="st">"d.b"</span>, <span class="st">"d.c"</span>, <span class="st">"d.d1"</span>, <span class="st">"d.d3"</span>, <span class="st">"d.d5"</span>, <span class="st">"d.e"</span>, <span class="st">"d.f"</span>, <span class="st">"d.g_lb"</span>, <span class="st">"d.g_ub"</span>), </span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"The baseline design"</span>, </span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... increasing power to 90%"</span>, </span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" ... setting Type I error rate to 1%"</span>, </span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>                      <span class="st">" ... applying a one-tailed test"</span>, </span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... sampling 20 students per school"</span>, </span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... sampling 60 students per school"</span>, </span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... sampling 100 students per school"</span>, </span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... assigning 75% of the schools to the treatment condition"</span>, </span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... assuming increased achievement differences at L2 of 20%"</span>, </span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... applying a liberal approach"</span>,</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"... applying a conservative approach"</span>)),</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">" requires J = "</span>, schools, <span class="st">" schools."</span>,<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(design <span class="sc">==</span> <span class="st">"d.0"</span>, <span class="st">""</span>, </span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(design <span class="sc">!=</span> <span class="st">"d.0"</span> <span class="sc">&amp;</span> delta <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste0</span>(<span class="st">"This amounts to "</span>, <span class="fu">round</span>(delta, <span class="dv">0</span>), </span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"% more schools compared to the baseline design."</span>),</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>           <span class="fu">ifelse</span>(design <span class="sc">!=</span> <span class="st">"d.0"</span> <span class="sc">&amp;</span> delta <span class="sc">==</span> <span class="dv">0</span>, </span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The required number of schools does not change compared to the baseline design."</span>,</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste0</span>(<span class="st">"This amounts to "</span>, <span class="fu">round</span>(delta, <span class="dv">0</span>)<span class="sc">*-</span><span class="dv">1</span>, </span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"% fewer schools compared to the baseline design."</span>)))),</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">""</span></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>    ))) <span class="sc">+</span></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">width=</span><span class="fl">0.9</span>) <span class="sc">+</span> </span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"Design"</span>) <span class="sc">+</span> </span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Number of schools"</span>) <span class="sc">+</span> </span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Number of Schools Required for an MDES of .25 by Design"</span>)</span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2815069026309ab4bfcc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2815069026309ab4bfcc">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11],"y":[73,97,109,57,84,69,66,111,112,61,85],"text":["The baseline design requires J = 73 schools.<br />","... increasing power to 90% requires J = 97 schools.<br />This amounts to 33% more schools compared to the baseline design."," ... setting Type I error rate to 1% requires J = 109 schools.<br />This amounts to 49% more schools compared to the baseline design."," ... applying a one-tailed test requires J = 57 schools.<br />This amounts to 22% fewer schools compared to the baseline design.","... sampling 20 students per school requires J = 84 schools.<br />This amounts to 15% more schools compared to the baseline design.","... sampling 60 students per school requires J = 69 schools.<br />This amounts to 5% fewer schools compared to the baseline design.","... sampling 100 students per school requires J = 66 schools.<br />This amounts to 10% fewer schools compared to the baseline design.","... assigning 75% of the schools to the treatment condition requires J = 111 schools.<br />This amounts to 52% more schools compared to the baseline design.","... assuming increased achievement differences at L2 of 20% requires J = 112 schools.<br />This amounts to 53% more schools compared to the baseline design.","... applying a liberal approach requires J = 61 schools.<br />This amounts to 16% fewer schools compared to the baseline design.","... applying a conservative approach requires J = 85 schools.<br />This amounts to 16% more schools compared to the baseline design."],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Number of Schools Required for an MDES of .25 by Design","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0.5,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,11.6],"tickmode":"array","ticktext":["d.0","d.a","d.b","d.c","d.d1","d.d3","d.d5","d.e","d.f","d.g_lb","d.g_ub"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11],"categoryorder":"array","categoryarray":["d.0","d.a","d.b","d.c","d.d1","d.d3","d.d5","d.e","d.f","d.g_lb","d.g_ub"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Design","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5.6000000000000005,117.59999999999999],"tickmode":"array","ticktext":["0","30","60","90"],"tickvals":[0,30,59.999999999999993,90],"categoryorder":"array","categoryarray":["0","30","60","90"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Number of schools","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"dcc30b56086":{"x":{},"y":{},"text":{},"type":"bar"}},"cur_data":"dcc30b56086","visdat":{"dcc30b56086":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="built-in-functionality-for-plotting-in-powerupr-1" class="level4">
<h4 class="anchored" data-anchor-id="built-in-functionality-for-plotting-in-powerupr-1">Built-in Functionality for Plotting in PowerUpR</h4>
<p>PowerUpR also comes with a built-in plotting function. We will quickly check out <code>PowerUpR::plot()</code> with the baseline design.</p>
<p>It is not possible to plot the required sample size. Instead, we can either plot the statistical power as a function of the sample size (which is the default)…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="fl">.0</span>, <span class="at">main =</span> <span class="st">"Power as a Function of the Number of Schools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="covariates_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>… or we can plot the <em>MDES</em> along with its (1-α)*100% CI as a function of the required number of schools.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># include `ypar = "mdes"` to plot the MDES</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># include `locate=TRUE` to locate parameter values for the applied design</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="fl">.0</span>, <span class="at">ypar =</span> <span class="st">"mdes"</span>, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"MDES as a Function of Number of Schools"</span>, <span class="at">locate =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="covariates_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>



</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-brunner2023" class="csl-entry" role="listitem">
Brunner, M., Stallasch, S. E., &amp; Lüdtke, O. (2023). Empirical Benchmarks to Interpret Intervention Effects on Student Achievement in Elementary and Secondary School: Meta-Analytic Results from Germany. <em>Journal of Research on Educational Effectiveness</em>, <em>17</em>(1), 119–157. <a href="https://doi.org/10.1080/19345747.2023.2175753">https://doi.org/10.1080/19345747.2023.2175753</a>
</div>
<div id="ref-moerbeek2015" class="csl-entry" role="listitem">
Moerbeek, M., &amp; Teerenstra, S. (2015). <em>Power analysis of trials with multilevel data</em>. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/b18676">https://doi.org/10.1201/b18676</a>
</div>
<div id="ref-pek2019" class="csl-entry" role="listitem">
Pek, J., &amp; Park, J. (2019). Complexities in power analysis: Quantifying uncertainties with a Bayesian-classical hybrid approach. <em>Psychological Methods</em>, <em>24</em>(5), 590–605. <a href="https://doi.org/10.1037/met0000208">https://doi.org/10.1037/met0000208</a>
</div>
<div id="ref-perugini2014" class="csl-entry" role="listitem">
Perugini, M., Gallucci, M., &amp; Costantini, G. (2014). Safeguard Power as a Protection Against Imprecise Power Estimates. <em>Perspectives on Psychological Science</em>, <em>9</em>(3), 319–332. <a href="https://doi.org/10.1177/1745691614528519">https://doi.org/10.1177/1745691614528519</a>
</div>
<div id="ref-spiegelhalter2003" class="csl-entry" role="listitem">
Spiegelhalter, D. J., Abrams, K. R., &amp; Myles, J. P. (2003). <em>Bayesian approaches to clinical trials and health<span>-</span>care evaluation</em>. <a href="https://doi.org/10.1002/0470092602">https://doi.org/10.1002/0470092602</a>
</div>
<div id="ref-stallasch2021" class="csl-entry" role="listitem">
Stallasch, S. E., Lüdtke, O., Artelt, C., &amp; Brunner, M. (2021). Multilevel Design Parameters to Plan Cluster-Randomized Intervention Studies on Student Achievement in Elementary and Secondary School. <em>Journal of Research on Educational Effectiveness</em>, <em>14</em>(1), 172–206. <a href="https://doi.org/10.1080/19345747.2020.1823539">https://doi.org/10.1080/19345747.2020.1823539</a>
</div>
<div id="ref-turner2004" class="csl-entry" role="listitem">
Turner, R. M., Toby Prevost, A., &amp; Thompson, S. G. (2004). Allowing for imprecision of the intracluster correlation coefficient in the design of cluster randomized trials. <em>Statistics in Medicine</em>, <em>23</em>(8), 1195–1214. <a href="https://doi.org/10.1002/sim.1721">https://doi.org/10.1002/sim.1721</a>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>